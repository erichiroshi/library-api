spring:
  datasource:
    url: ${DB_URL:jdbc:postgresql://localhost:5432/library}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        '[format_sql]': true

# Flyway
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: 
      - classpath:db/migration/common
      - classpath:db/migration/dev

# Redis
  cache:
    type: redis
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: 6379
      timeout: 60000
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
      repositories:
       enabled: false

# ═══════════════════════════════════════════════════════════════════
# SCHEDULED TASKS
# ═══════════════════════════════════════════════════════════════════
  task:
    scheduling:
      pool:
        # Número de threads para tarefas agendadas
        size: 2

# Configuração do cleanup job (opcional - customizar cron)
# refresh-token:
#   cleanup:
#     # Cron: todo dia às 2h AM
#     cron: 0 0 2 * * *
#     # Alternativas:
#     # - A cada hora: 0 0 * * * *
#     # - A cada 6 horas: 0 0 */6 * * *
#     # - Toda segunda às 3h AM: 0 0 3 * * MON		

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always

logging:
  level:
    '[com.example.library]': DEBUG
    '[org.hibernate.SQL]': DEBUG
    '[org.hibernate.orm.jdbc.bind]': TRACE

# ═══════════════════════════════════════════════════════════════════
# JWT & REFRESH TOKEN CONFIGURATION
# ═══════════════════════════════════════════════════════════════════

jwt:
  # Chave secreta para assinatura do JWT (mínimo 256 bits para HS256)
  # PRODUÇÃO: usar variável de ambiente JWT_SECRET_KEY
  # Dev pode usar default, mas AVISAR no log
  secret-key: ${JWT_SECRET_KEY:dev-insecure-key-for-local-development-only-do-not-use-in-production}
  
  # Duração do access token em segundos (15 minutos = 900 segundos)
  # Dev: access token de 30 minutos (mais conveniente)
  access-token-seconds: ${JWT_ACCESS_TOKEN-SECONDS:1800}

  # Duração do refresh token em dias (7 dias é padrão seguro)
  # Produção: 7 dias
  # Desenvolvimento: 14 dias (conveniência)
  refresh-token-days: ${JWT_REFRESH_TOKEN_DAYS:14}
